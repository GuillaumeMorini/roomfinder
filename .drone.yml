pipeline:
  build:
    image: python:2-alpine
    commands:
      - echo "Beginning new build"
      - pip install -r roomfinder_spark/requirements.txt
      - python testing.py
  publish:
    image: plugins/docker
    repo: guismo/roomfinder_spark
    file: roomfinder_spark/Dockerfile
    tag: [ latest ]
    secrets: [ docker_username, docker_password ]
    when:
      branch: dev
      event: push

  # notify:
  #     spark:
  #         image: hpreston/drone-spark
  #         auth_token: ZTE2NjRiN2YtOTdjMy00M2RlLTk2NjQtNTE3NWZhZjU5ZmY5YmY3MTM5MDAtY2Zi
  #         roomId: Y2lzY29zcGFyazovL3VzL1JPT00vNGZhZDViMTAtNWMxMS0xMWU3LThkNzMtZDllYWI0MTFkYzIy

